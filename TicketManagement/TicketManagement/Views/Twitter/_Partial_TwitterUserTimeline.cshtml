@using TicketManagement.ViewModels
@model IEnumerable<TwitterTweetViewModel>

@if (Model == null)
{
    <p>Please check that you have associated your account with Twitter</p>
}
else
{
    <div>
        @foreach (TwitterTweetViewModel tweet in Model)
        {
            @*<div class="panel panel-info">
                <div class="panel-heading">
                    <strong>@tweet.Text</strong>
                </div>
            </div>*@

            <div class="list-group panel">

                @if (tweet.Replies.Count < 1) // If there are no replies just display the basic Panel
                {
                    <a href="#" class="list-group-item list-group-item-info"><strong>@tweet.Text</strong></a>
                }
                else
                {
                    string tweetId = $"#{tweet.TwitterId}";
                    <a href="@tweetId" class="list-group-item list-group-item-info" data-toggle="collapse" data-parent="@tweetId"><strong><i class="fa fa-caret-down"></i> @tweet.Text</strong></a>

                    <div class="collapse" id="@tweet.TwitterId">
                        @foreach (TwitterTweetViewModel tweetReply in tweet.Replies)
                        {
                            @HandleTwitterTweetViewModels(tweetId, tweetReply)
                        }
                    </div>
                }
            </div>
        }
    </div>
}

@helper HandleTwitterTweetViewModels(string parentId, TwitterTweetViewModel vm)
{

string tweetId = $"#{vm.TwitterId}";

    if (vm.Replies.Count < 1) // If there are no replies just display the basic Panel
    {
        <a href="#" class="list-group-item" data-parent="@parentId">@vm.Text</a>
    }
    else
    {
        <a href="@tweetId" class="list-group-item" data-toggle="collapse" data-parent="@parentId"><i class="fa fa-caret-down"></i> @vm.Text</a>

        <div class="collapse list-group-submenu" id="@vm.TwitterId" style="margin-left: 20px">

            @foreach (TwitterTweetViewModel tweetReply in vm.Replies)
            {
                @HandleTwitterTweetViewModels(tweetId, tweetReply)
            }

        </div>
    }
}

@*<style type="text/css">
        .list-group.panel > .list-group-item {
            border-bottom-right-radius: 4px;
            border-bottom-left-radius: 4px;
        }

        .list-group-submenu {
            margin-left: 20px;
        }
    </style>*@